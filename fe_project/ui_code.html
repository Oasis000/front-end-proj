<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>주식 예측 페이지</title>
  <!-- 필요한 CSS 또는 스타일링 코드 -->

  <!-- 차트를 그리기 위한 Chart.js CDN 링크 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* 디자인을 위한 css코드 */
    /* display - 배치한다 (가로 또는 세로).
    #로 시작하는 것은 아이디, .button -> 요거는 클래스
    */
    #stockChart { 
      max-width: 2000px;
      margin: 7%;
    }
    /* 버튼 컨테이너 */
    .button-row {
      flex-direction: column;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 10px; /* 각 행 사이의 간격 조정 */
    }

    .button-container {
        display: block;
        flex-direction: row;
        margin-bottom: 20px; /* 각 컨테이너 사이의 간격 조정 */
    }

    .stock-button {
        display: inline-block;
        margin-bottom: 20px;
        flex: 1;
        margin: 10px;
        padding: 10px 20px; /* 위아래 10px, 좌우 20px의 안쪽 여백 설정 */
        min-width: 100px; /* 최소 너비를 지정하여 버튼이 너무 작아지지 않도록 함 */
        text-align: center;
        background-color: black;
        color: white;
        border-radius: 10px;
        cursor: pointer;
    }
    #toggleButton {
      background-color: rgb(40, 40, 135); /* 배경색 */
      color: white; /* 글자색 */
      padding: 9px 15px;
      border: none;
      margin-top: 10px;
      border-radius: 20px;
      cursor: pointer;
    }
    /* 눌렀을 때 색*/
    .stock-button:hover {
      background-color: darkblue;
    }
    
    .pre-container{
      text-align: center;
    }
    .prediction-button {
      justify-content: center;
      padding: 10px 20px;
      background-color: #3498db;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .prediction-button:hover {
      background-color: #2980b9;
    }
    /*구분선*/
    .divider {
            border-top: 1px solid #ccc; /* 회색 실선을 위쪽에 추가합니다. */
            margin: 20px 0; /* 구분선 위아래 여백을 조절합니다. */
    }

    .left-container{
      text-align: right;
    }

    .info-container{
      text-align: center;
    }

    /* 팀 정보를 알려주는 세부 정보 버튼 -> 페이지 크기 변화 시 동적으로 변화하도록 설정*/
    .info {
      display: none;
      position: fixed;
      top: 10%;
      right: 5%;
      left:10%;
      bottom:10%;
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      overflow: auto;
      max-height: 500px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>

<!-- 클래스의 위치를 변경하면 페이지에서 변경됨. -->


<div class="left-container">
  <button id="toggleButton">팀 소개 보기</button>
</div>

<div class="divider">

</div>
<h1>주식 예측 페이지</h1>
<!-- /*## "KB금융 105560 신한지주 055550 하나금융지주 086790 메리츠금융지주 138040 기업은행 024110 미래에셋증권 006800 NH투자증권 005940 삼성증권 016360".split()*/ -->




<body onload="displayDate()">
  <h4>오늘의 날짜는 <u><span id="date"></span></u> 입니다</h4>

</body>

<!-- <img src="./mymero.jpg"> -->

<!-- 주식 가격 그래프를 그릴 캔버스 -->
<canvas id="stockChart",width = "200" height="130"></canvas>


<!-- 종목 버튼 -->
<div class="button-row">
    <div class="botton-container">
      <button class="stock-button" onclick="sendStockRequest('KB금융')">KB금융</button>
      <button class="stock-button" onclick="sendStockRequest('신한지주')">신한지주</button>
      <button class="stock-button" onclick="sendStockRequest('하나금융지주')">하나금융지주</button>
      <button class="stock-button" onclick="sendStockRequest('메리츠금융지주')">메리츠금융지주</button>
    </div>
    <div class="button-container">
      <button class="stock-button" onclick="sendStockRequest('기업은행')">기업은행</button>
      <button class="stock-button" onclick="sendStockRequest('미래에셋증권')">미래에셋증권</button>
      <button class="stock-button" onclick="sendStockRequest('NH투자증권')">NH투자증권</button>
      <button class="stock-button" onclick="sendStockRequest('삼성증권')">삼성증권</button>
    </div>

</div>

<div class="divider"> </div>

<div class="pre-container"> 
    <button class="prediction-button" onclick="sendPredictionRequest()">예측 결과 보기</button>
</div>




<div class="right-container">
  <div class="info" id="infoBox">
    <div id="info">
        <h2>팀 소개</h2>
        우리는 한양대학교 학생이며 졸업프로젝트로 진행한 ~~ 을 웹으로 만들어 보았다. 
        이 사이트로는 8개의 종목을 svm, TF, lstm 3개의 모델로 분석해 볼 수 있다.<br><br>
        <div class = "info-container">
            <img src="./ensemble_model.drawio (1).png">
        </div>
        
        <li>
            BE : 이수빈
            <p>백엔드 개발 </p>
  
        </li>
  
        <li>
            FE : 김나현
            <p>html, JavaScript, css를 사용했으며 등</p>
        </li>
  
        <a href="https://github.com/Hanyang-SN/Stock-Price-Prediction">깃허브 주소</a>
  
  </div>
  
</div>


<script>
  var selected_stock = null;

  // 주식 가격 그래프 표시 함수
  function showStockGraph(stockData) {
    selected_stock = stockData;

    const dates = Object.keys(stockData).reverse();
    const prices = dates.map(date => parseFloat(stockData[date]['4. close']));

    // Chart.js를 사용하여 그래프 그리기
    const ctx = document.getElementById('stockChart').getContext('2d');
    const stockChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: dates,
        datasets: [{
          label: '주식 가격',
          data: prices,
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    });
  }


  // 선택한 종목을 백엔드로 전송하는 함수
  function sendStockRequest(stockName) {

    // TODO: AJAX 또는 Fetch API를 사용하여 선택한 종목을 백엔드에 전송하는 코드를 작성해야 합니다.
    // 서버에 선택한 종목(stockName)을 보내고, 백엔드에서 주식 가격 정보를 받아와야 합니다.
    console.log(`선택한 종목: ${stockName}`);


    // 받아온 데이터로 showStockGraph 함수 호출
    const mockStockData = {
      // hard coding -> 실제 백엔드에서 받아야 함.
      '2023-11-15': {'4. close': '100'},
      '2023-11-14': {'4. close': '110'},       
      '2023-11-13': {'4. close': '120'},
      '2023-11-12': {'4. close': '90'},
      '2023-11-11': {'4. close': '20'},
      '2023-11-10': {'4. close': '170'},
      '2023-11-09': {'4. close': '110'},
    };
    showStockGraph(mockStockData);
  }

  // 예측 결과를 백엔드로 전송하는 함수
  function sendPredictionRequest() {

    if(selected_stock == null){
      alert("종목을 먼저 선택하세요");
    } 

    // TODO: 예측 요청을 백엔드에 보내고 결과를 받아오는 코드를 작성해야 합니다.
    console.log('예측 결과 요청');
    // AJAX 또는 Fetch API를 사용하여 예측 결과를 요청하는 코드
    // 받아온 결과를 화면에 표시하는 로직을 작성해야 합니다.
  }

  // JavaScript를 사용하여 현재 날짜를 가져오는 함수.
  function displayDate() {
    const today = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const formattedDate = today.toLocaleDateString('ko-KR', options);
    document.getElementById('date').textContent = formattedDate;
  }


  // 버튼 요소와 정보를 표시할 요소를 가져옵니다.
  var displayButton = document.getElementById("displayButton");
  var info = document.getElementById("info");

  // 버튼 클릭 시 정보를 표시하는 함수
  displayButton.addEventListener("click", function() {
      // 정보를 표시하거나 숨기는 토글 기능을 구현합니다.
      if (info.style.display === "none") {
          info.style.display = "block";
      } else {
          info.style.display = "none";
      }
  });

</script>


<!-- 상세 페이지 버튼 -->
<script>    
  const toggleButton = document.getElementById('toggleButton');
  const infoBox = document.getElementById('infoBox');

  toggleButton.addEventListener('click', function() {
    if (infoBox.style.display === 'none' || infoBox.style.display === '') {
      infoBox.style.display = 'block';
      toggleButton.textContent = '팀 소개 숨기기';
    } else {
      infoBox.style.display = 'none';
      toggleButton.textContent = '팀 소개 보기';
    }
  });
</script>


</body>


</html>
